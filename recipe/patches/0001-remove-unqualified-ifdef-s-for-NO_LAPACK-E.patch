From d1e70ff534b9335c7b1e3474e3dc89ab1dd0fa58 Mon Sep 17 00:00:00 2001
From: "H. Vetinari" <h.vetinari@gmx.com>
Date: Tue, 28 Mar 2023 18:51:30 +1100
Subject: [PATCH 1/2] remove unqualified ifdef's for NO_LAPACK(E)

---
 Makefile.install       | 4 ++--
 driver/level2/Makefile | 2 +-
 interface/Makefile     | 8 ++++----
 3 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/Makefile.install b/Makefile.install
index 87b5bc87..01899b97 100644
--- a/Makefile.install
+++ b/Makefile.install
@@ -77,7 +77,7 @@ endif
 endif
 
 ifneq ($(OSNAME), AIX)
-ifndef NO_LAPACKE
+ifneq ($(NO_LAPACKE), 1)
 	@echo Copying LAPACKE header files to $(DESTDIR)$(OPENBLAS_INCLUDE_DIR)
 	@-install -m644 $(NETLIB_LAPACK_DIR)/LAPACKE/include/lapack.h "$(DESTDIR)$(OPENBLAS_INCLUDE_DIR)/lapack.h"
 	@-install -m644 $(NETLIB_LAPACK_DIR)/LAPACKE/include/lapacke.h "$(DESTDIR)$(OPENBLAS_INCLUDE_DIR)/lapacke.h"
@@ -127,7 +127,7 @@ endif
 
 else
 #install on AIX has different options syntax
-ifndef NO_LAPACKE
+ifneq ($(NO_LAPACKE), 1)
 	@echo Copying LAPACKE header files to $(DESTDIR)$(OPENBLAS_INCLUDE_DIR)
 	@-installbsd -c -m 644 $(NETLIB_LAPACK_DIR)/LAPACKE/include/lapack.h "$(DESTDIR)$(OPENBLAS_INCLUDE_DIR)/lapack.h"
 	@-installbsd -c -m 644 $(NETLIB_LAPACK_DIR)/LAPACKE/include/lapacke.h "$(DESTDIR)$(OPENBLAS_INCLUDE_DIR)/lapacke.h"
diff --git a/driver/level2/Makefile b/driver/level2/Makefile
index 9bef6e2a..5f8c712a 100644
--- a/driver/level2/Makefile
+++ b/driver/level2/Makefile
@@ -92,7 +92,7 @@ CBLASOBJS += \
 	ctrsv_RUU.$(SUFFIX) ctrsv_RUN.$(SUFFIX) ctrsv_RLU.$(SUFFIX) ctrsv_RLN.$(SUFFIX) \
 	ctrsv_CUU.$(SUFFIX) ctrsv_CUN.$(SUFFIX) ctrsv_CLU.$(SUFFIX) ctrsv_CLN.$(SUFFIX)
 
-ifndef NO_LAPACK
+ifneq ($(NO_LAPACK), 1)
 CBLASOBJS += \
 	cspmv_U.$(SUFFIX) cspmv_L.$(SUFFIX) \
 	cspr_U.$(SUFFIX)  cspr_L.$(SUFFIX)  \
diff --git a/interface/Makefile b/interface/Makefile
index 3db4b2b6..b6c581a9 100644
--- a/interface/Makefile
+++ b/interface/Makefile
@@ -1021,7 +1021,7 @@ dsymv.$(SUFFIX) dsymv.$(PSUFFIX) : symv.c
 qsymv.$(SUFFIX) qsymv.$(PSUFFIX) : symv.c
 	$(CC) -c $(CFLAGS) $< -o $(@F)
 
-ifndef NO_LAPACK
+ifneq ($(NO_LAPACK), 1)
 csymv.$(SUFFIX) csymv.$(PSUFFIX) : zsymv.c
 	$(CC) -c $(CFLAGS) $< -o $(@F)
 
@@ -1041,7 +1041,7 @@ dsyr.$(SUFFIX) dsyr.$(PSUFFIX) : syr.c
 qsyr.$(SUFFIX) qsyr.$(PSUFFIX) : syr.c
 	$(CC) -c $(CFLAGS) $< -o $(@F)
 
-ifndef NO_LAPACK
+ifneq ($(NO_LAPACK), 1)
 csyr.$(SUFFIX) csyr.$(PSUFFIX) : zsyr.c
 	$(CC) -c $(CFLAGS) $< -o $(@F)
 
@@ -1115,7 +1115,7 @@ dspmv.$(SUFFIX) dspmv.$(PSUFFIX) : spmv.c
 qspmv.$(SUFFIX) qspmv.$(PSUFFIX) : spmv.c
 	$(CC) -c $(CFLAGS) $< -o $(@F)
 
-ifndef NO_LAPACK
+ifneq ($(NO_LAPACK), 1)
 cspmv.$(SUFFIX) cspmv.$(PSUFFIX) : zspmv.c
 	$(CC) -c $(CFLAGS) $< -o $(@F)
 
@@ -1135,7 +1135,7 @@ dspr.$(SUFFIX) dspr.$(PSUFFIX) : spr.c
 qspr.$(SUFFIX) qspr.$(PSUFFIX) : spr.c
 	$(CC) -c $(CFLAGS) $< -o $(@F)
 
-ifndef NO_LAPACK
+ifneq ($(NO_LAPACK), 1)
 cspr.$(SUFFIX) cspr.$(PSUFFIX) : zspr.c
 	$(CC) -c $(CFLAGS) $< -o $(@F)
 
-- 
2.38.1.windows.1

